/*! Single page application framework - v0.2.2 - 2016-04-18
* https://github.com/dzhdmitry/spa
* Copyright (c) 2016 Dmitry Dzhuleba;
* Licensed MIT
*/
!function(a,b){"function"==typeof define&&define.amd?define(["underscore","backbone"],b):a.SPA=b(a._,a.Backbone)}(this,function(a,b){var c={};return a?b?(c.View=b.View.extend({tagName:"div",initialize:function(){this.listenTo(this.model,"change",this.render)},template:function(a){return""},render:function(){if(!this.model.rendered){var a=this.template(this.model.toJSON());this.$el.html(a),this.model.rendered=!0}return this.toggle(this.model.get("active")),this},toggle:function(a){var b=a?"block":"none";this.$el.css("display",b)}}),c.Model=b.Model.extend({idAttribute:"uri",defaults:{active:!1,title:""},initialize:function(a,b){this.rendered=!1,c.Model.__super__.initialize.call(this,a,b)},show:function(){this.set("active",!0),b.$("title").html(this.get("title")),this.hasChanged("active")&&this.trigger("shown")},hide:function(){this.set("active",!1),this.hasChanged("active")&&this.trigger("hidden")}}),c.Collection=b.Collection.extend({model:c.Model,view:c.View,createView:function(a){var b=new this.view({model:a});this.el.append(b.render().el)},open:function(a){this.each(function(b){b.get("uri")==a?b.show():b.hide()})}}),c.Router=b.Router.extend({collection:c.Collection,initialize:function(d){var e={el:b.$("body"),start:!0,pushState:!1,root:"/"},f=a.extend({},e,d);this.pushState=f.pushState,this.root=f.root,this.pages=new this.collection,this.pages.el=f.el,this.listenTo(this.pages,"add",function(a,b){b.createView(a)}),f.start&&b.history.start({pushState:f.pushState,root:f.root}),c.Router.__super__.initialize.call(this,d)},start:function(){b.history.start({pushState:this.pushState,root:this.root})},go:function(c){var d=this.pushState?b.history.getPath():b.history.getHash(),e=a.extend({uri:d},c);this.pages.add(e),this.pages.open(e.uri)}}),c):void console.error("Backbone is required by SPA"):void console.error("Underscore is required by SPA")});